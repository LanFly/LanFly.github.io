<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PHP自动刷新花生壳公网IP | BluesCode</title>
    <link rel='stylesheet' id='heidi-style-css' href='/css/heidi.css' type='text/css' media='all' />
    <meta name="generator" content="github pages" />
    <style type="text/css">
    .content-area a,
    .content-area a:visited {
        color: ;
    }
    
    .site-header,
    .main-navigation ul ul li,
    .site-footer {
        background: ;
    }
    </style>
    <style type="text/css">
    .sticky .entry-header {
        border-top-color: ;
    }
    
    .sticky .entry-footer {
        border-bottom-color: ;
    }
    
    .sticky a {
        color: ;
    }
    
    blockquote {
        border-left-color: ;
    }
    
    .more-link {
        background: ;
    }
    
    .hentry h1 a,
    .posted-on a,
    .more-link:hover,
    .more-link:focus {
        color: ;
    }
    </style>
    <style type="text/css">
    .hentry,
    .comments-area {
        background: ;
    }
    </style>
    <style type="text/css">
    .entry-footer,
    .comment-body,
    .single-post-thumbnail,
    table,
    pre {
        background: ;
    }
    </style>
    <style type="text/css">
    .hentry,
    .comments-area {
        border-color: ;
    }
    </style>
    <style type="text/css">
    .sticky,
    blockquote {
        background: !important;
    }
    </style>
    <style type="text/css">
    .sticky .entry-footer,
    .sticky blockquote,
    thead {
        background: !important;
    }
    </style>
    <style type="text/css">
    .widget-area,
    .date_with_link:hover,
    .page-title {
        background: ;
    }
    
    .widget_calendar td > a,
    .widget_calendar td > a:focus,
    .sticky a:hover,
    .sticky a:focus,
    a:hover,
    a:focus,
    a:active {
        color: ;
    }
    
    @media all and (min-width: 1024px) {
        .widget-area {
            background: transparent;
        }
        .widget {
            background: ;
        }
    }
    </style>
    <style type="text/css">
    .widget-area a {
        color: ;
    }
    </style>
    <style type="text/css">
    .widget-area table {
        background: ;
    }
    </style>
    <style type="text/css">
    .widget-area td,
    .widget-area th {
        border-color: ;
    }
    </style>
    <style type="text/css">
    .recentcomments a {
        display: inline !important;
        padding: 0 !important;
        margin: 0 !important;
    }
    </style>
</head>

<body class="home blog">
    <div id="page" class="hfeed site">
        <header id="masthead" role="banner" class="site-header">
            <div class="site-branding">
                <h1 class="site-title"><a href="/" rel="home" title="回到首页">BluesCode</a></h1>
                <h2 class="site-description">一个以兴趣驱动的个人博客</h2>
                <span class="nav-toggle hidden" title="菜单" href="#">
                    <div class="bars">
                        <div class="bar"></div>
                        <div class="bar"></div>
                        <div class="bar"></div>
                        <div class="clear"></div>
                    </div>
                    <p>
                        <span class="menu">Menu</span>
                <span class="close">Close</span>
                </p>
                </span>
            </div>
            <!-- .site-branding -->
        </header>
        <ul class="mobile-menu">
            <li class="menu-item"><a href="/">首页</a></li>
            <li class="menu-item"><a href="/web">Web前端</a></li>
            <li class="menu-item"><a href="/mac">MacOSX</a></li>
            <li class="menu-item"><a href="/resource">干货分享</a></li>
            <li class="menu-item"><a href="/laneditor" title="一款个性化在线markdown编辑器">LanEditor</a></li>
        </ul>
        <!-- #masthead -->
        <div id="content" class="site-content">
            <div id="primary" class="content-area">
                <main id="main" class="site-main" role="main">
                    <article id="post-52" class="post-52 post type-post status-publish format-standard hentry category-all">
                        <header class="entry-header">
                            <h1 class="entry-title">PHP自动刷新花生壳公网IP</h1>
                            <div class="entry-meta">
                                <span class="posted-on">最后编辑：<a href="" rel="bookmark"><time class="entry-date published" datetime="2016-01-14T15:05:59+00:00">2016年1月14日</time></a></span><span class="byline"> by <span class="author vcard"><a class="author-url" href="">BluesCode</a></span></span>
                            </div>
                            <!-- .entry-meta -->
                        </header>
                        <!-- .entry-header -->
                        <div class="entry-content">
                            <p>树莓派火的不行，于是我也于2015年忍不住入了一块B+。附带亚克力透明板、一个小风扇。插上32G内存卡，运行<code class="highlighter-rouge">raspbian</code>，酷的不行！
我的小站后台就是搭在这个树莓派上，然后使用花生壳的动态域名解析IP。对于一些个人博客或是私有云服务来说，相当便利啊！</p>

<p><img src="/images/resource/auto-set-oray-ip-rasp.jpg" alt="我的树莓派" /></p>

<p>提到花生壳动态域名，那么问题来了。现在的个人/小区宽带，基本都不是公网IP了，使用花生壳的公网版免费服务的前提是你有公网IP。
所以你使用官网提供的工具自动解析的IP是不正确的，这个问题困扰了我一段时间。以前我的后台服务是放在SAE上的，但是随着SAE收费越来越高，
我就hold不住了。偶然间我在官网上看到一个设置IP地址的http API，于是我做了一个小实验：首先我查看了自己路由器的外网IP，然后用这个API
设置IP为我的路由器外网IP，然后访问，结果解析正确了。机智的我立马就写了一个PHP程序去自动解析IP地址。</p>

<h4 id="section">思路</h4>

<p>首先我说一下我的网络环境。我使用一台小米mini路由器连接外网，接了一台电脑A，和一台路由器A。路由器A接另一台电脑B和树莓派。
这样我可以一个宽带账号同时提供多台电脑的网络访问。</p>

<p>原理就是先获取路由器的外网IP，然后解析域名的IP，比对一下，如果两个IP不同，那么就设置IP为新的IP地址，否则什么也不做。
当然还要在路由器上做端口映射，否则即使解析正确的IP也访问不了。也可以直接设置DMZ。这个比较简单，就不说了。
这样每10分钟解析一次，即使你的外网IP变动，也可以保持一直解析正确。</p>

<p>这是花生壳提供的API：</p>

<div class="language-text highlighter-rouge"><pre class="highlight"><code>http://username:password@ddns.oray.com/ph/update?hostname=yourhostname&amp;myip=ipaddress
</code></pre>
</div>

<p><strong>参数说明</strong></p>

<ul>
  <li>username 是你的账号</li>
  <li>password 是你的密码</li>
  <li>yourhostname 是你想要设置IP的域名</li>
  <li>ipaddress 是你要设置的IP值</li>
</ul>

<p>把上面的值相应的换成你自己的就可以访问了。可以直接在浏览器中访问该地址，会返回相应的提示。</p>

<p>下面就是写一个程序去自动设置IP了。</p>

<h4 id="section-1">程序主循环</h4>

<div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="c1">//让程序一直运行不要退出
</span><span class="k">while</span><span class="p">(</span><span class="kc">true</span><span class="p">){</span>
    <span class="nv">$times</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="c1">//解析域名的IP地址，返回10进制的IP地址形式。如果解析失败，则原样返回域名字符串
</span>    <span class="nv">$remote</span> <span class="o">=</span> <span class="nb">gethostbyname</span><span class="p">(</span><span class="s2">"your host name"</span><span class="p">);</span>
    <span class="c1">//自定义的方法，获取本机外网IP。原理是通过访问 http://1212.ip138.com/ic.asp 获取
</span>    <span class="nv">$localhost</span> <span class="o">=</span> <span class="nx">GetMyIP</span><span class="p">();</span>
    <span class="c1">//判断网络是否正常，直到获取到外网IP
</span>    <span class="k">while</span><span class="p">(</span><span class="nv">$remote</span> <span class="o">==</span> <span class="s2">"your host name"</span> <span class="o">||</span> <span class="nv">$localhost</span> <span class="o">==</span> <span class="kc">false</span><span class="p">){</span>
    	<span class="c1">//解析IP失败次数大于5次，则休眠30分钟后再次尝试
</span>        <span class="k">if</span><span class="p">(</span><span class="nv">$times</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">){</span>
            <span class="k">echo</span> <span class="nx">GetTime</span><span class="p">()</span><span class="o">.</span><span class="s2">" Network Error! Retry times: </span><span class="si">{</span><span class="nv">$times</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
            <span class="k">echo</span> <span class="nx">GetTime</span><span class="p">()</span><span class="o">.</span><span class="s2">" The program start sleep 30 min, because network error</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
            <span class="nv">$times</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nb">sleep</span><span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="mi">60</span><span class="p">);</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">//休眠15秒
</span>        <span class="nb">sleep</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>
        <span class="nv">$remote</span> <span class="o">=</span> <span class="nb">gethostbyname</span><span class="p">(</span><span class="s2">"your host name"</span><span class="p">);</span>
        <span class="nv">$localhost</span> <span class="o">=</span> <span class="nx">GetMyIP</span><span class="p">();</span>
        <span class="nv">$times</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">//判断外网IP和域名解析的IP是否相同
</span>    <span class="k">if</span><span class="p">(</span><span class="nv">$remote</span> <span class="o">!=</span> <span class="nv">$localhost</span><span class="p">){</span>
        <span class="nv">$result</span><span class="p">;</span>
        <span class="nv">$times</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="c1">//一直设置IP，直到设置成功，因为有可能设置失败
</span>        <span class="k">do</span><span class="p">{</span>
        	<span class="c1">//设置IP失败次数大于5次，则休眠10分钟后再次尝试
</span>            <span class="k">if</span><span class="p">(</span><span class="nv">$times</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">){</span>
                <span class="k">echo</span> <span class="nx">GetTime</span><span class="p">()</span><span class="o">.</span><span class="s2">" Set IP Error! Retry times: </span><span class="si">{</span><span class="nv">$times</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
                <span class="k">echo</span> <span class="nx">GetTime</span><span class="p">()</span><span class="o">.</span><span class="s2">" The program start sleep 10 min, because set ip error</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
                <span class="nv">$times</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nb">sleep</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="mi">60</span><span class="p">);</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="c1">//自定义方法，设置IP
</span>            <span class="nv">$result</span> <span class="o">=</span> <span class="nx">SetIP</span><span class="p">(</span><span class="nv">$localhost</span><span class="p">);</span>
            <span class="k">echo</span> <span class="nx">GetTime</span><span class="p">()</span><span class="o">.</span><span class="s2">" SetIP remote: </span><span class="si">{</span><span class="nv">$remote</span><span class="si">}</span><span class="s2"> router: </span><span class="si">{</span><span class="nv">$localhost</span><span class="si">}</span><span class="s2"> "</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s1">'status: '</span><span class="o">.</span><span class="nv">$result</span><span class="p">[</span><span class="s1">'state'</span><span class="p">]</span><span class="o">.</span><span class="s2">" message: "</span><span class="o">.</span><span class="nv">$result</span><span class="p">[</span><span class="s1">'content'</span><span class="p">]</span><span class="o">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
            <span class="nv">$times</span><span class="o">++</span><span class="p">;</span>
            <span class="c1">//间隔15秒设置一次IP
</span>            <span class="nb">sleep</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>
        <span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">[</span><span class="s1">'state'</span><span class="p">]);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="k">echo</span> <span class="nx">GetTime</span><span class="p">()</span><span class="o">.</span><span class="s2">" NoSet remote: </span><span class="si">{</span><span class="nv">$remote</span><span class="si">}</span><span class="s2"> router: </span><span class="si">{</span><span class="nv">$localhost</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="nx">GetTime</span><span class="p">()</span><span class="o">.</span><span class="s2">" All done! Sleep 10 min</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
    <span class="c1">//每10分钟刷新一次IP
</span>    <span class="nb">sleep</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="mi">60</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
</div>

<p>这就是程序的主循环。主要做了2件事。一是获取本机外网IP和域名的IP。二是比对2个IP，如果不相等，则将域名设置成最新的
外网IP，否则休眠一段时间。继续重复。注意域名要换成你自己的。</p>

<h4 id="setipip">再来看<code class="highlighter-rouge">SetIP($ip)</code>函数</h4>

<div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="c1">//$ip为要设置IP的值，10进制字符串格式
</span><span class="k">function</span> <span class="nf">SetIP</span><span class="p">(</span><span class="nv">$ip</span><span class="p">){</span>
    <span class="nv">$handle</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
    <span class="nv">$option</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    	<span class="c1">//注意这里要换成你自己的账号信息
</span>        <span class="nx">CURLOPT_URL</span><span class="o">=&gt;</span><span class="s2">"http://username:password@ddns.oray.com/ph/update?hostname=yourhostname&amp;myip="</span><span class="o">.</span><span class="nv">$ip</span><span class="p">,</span>
        <span class="nx">CURLOPT_USERAGENT</span><span class="o">=&gt;</span><span class="s2">"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"</span><span class="p">,</span>
        <span class="nx">CURLOPT_AUTOREFERER</span><span class="o">=&gt;</span><span class="kc">true</span><span class="p">,</span>
        <span class="nx">CURLOPT_TIMEOUT</span><span class="o">=&gt;</span><span class="mi">15</span><span class="p">,</span>
        <span class="nx">CURLOPT_HEADER</span><span class="o">=&gt;</span><span class="kc">false</span><span class="p">,</span>
        <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="o">=&gt;</span><span class="kc">true</span><span class="p">,</span>
        <span class="nx">CURLOPT_ENCODING</span><span class="o">=&gt;</span><span class="s2">"gzip, deflate, sdch"</span><span class="p">,</span>
        <span class="nx">CURLOPT_REFERER</span><span class="o">=&gt;</span><span class="s2">"http://ddns.oray.com"</span>
    <span class="p">);</span>
    <span class="nv">$header</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s2">"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span><span class="p">,</span>
        <span class="s2">"Upgrade-Insecure-Requests: 1"</span><span class="p">,</span>
        <span class="s2">"Accept-Language: zh-CN,zh;q=0.8"</span><span class="p">,</span>
        <span class="s2">"Host: ddns.oray.com"</span><span class="p">,</span>
        <span class="c1">//特别注意这里，下文有详细讲解
</span>        <span class="s2">"Authorization: Basic hUBdMTR2MD5f83JheFGsbW0x0Cl0"</span>
    <span class="p">);</span>
    <span class="nv">$opt</span> <span class="o">=</span> <span class="nb">curl_setopt_array</span><span class="p">(</span><span class="nv">$handle</span><span class="p">,</span> <span class="nv">$option</span><span class="p">);</span>
    <span class="nv">$opt</span> <span class="o">=</span> <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$handle</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="nv">$header</span><span class="p">);</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">){</span>
        <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
            <span class="s2">"state"</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">,</span>
            <span class="s2">"content"</span> <span class="o">=&gt;</span> <span class="s2">"timeout"</span>
        <span class="p">);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
    	<span class="c1">//解析返回的字符串，成功会有good字符串，使用正则匹配
</span>    	<span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/good/'</span><span class="p">,</span> <span class="nv">$result</span><span class="p">)){</span>
			<span class="k">return</span> <span class="k">array</span><span class="p">(</span>
				<span class="s2">"state"</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
				<span class="s2">"content"</span> <span class="o">=&gt;</span> <span class="nv">$result</span>
			<span class="p">);</span>
    	<span class="p">}</span><span class="k">else</span><span class="p">{</span>
			<span class="k">return</span> <span class="k">array</span><span class="p">(</span>
				<span class="s2">"state"</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">,</span>
				<span class="s2">"content"</span> <span class="o">=&gt;</span> <span class="nv">$result</span>
			<span class="p">);</span>
    	<span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
</div>

<p>这个函数就是使用curl调用官网提供的API。这里特别注意上面的header头里面的<code class="highlighter-rouge">Authorization</code>字段，如果不设置此字段，
那么设置IP成功的几率很小，只在第一次访问的时候能成功，以后都会失败。原因就是第一次调用这个API的时候，会返回一个
验证字段，如果你不带上这个字段，那么验证就不会通过。所以我们要手动加上这个字段。</p>

<p>那么如何获取呢？答案就是先手动
用浏览器去访问一次。</p>

<ul>
  <li>打开F12调试工具，切换到里面的Network面板。这里可以查看发送的http包。</li>
  <li>在地址栏里输入API地址。按回车。</li>
</ul>

<p>这个时候Network面板里面应该就会出现一个http包了。点击它，就能看到详细内容，然后复制<code class="highlighter-rouge">Authorization</code>
的值。</p>

<p>好了，程序到这里就写完了。剩下的就是要让程序一直在后台运行，这样可以继续执行其他的操作。</p>

<p>如果你是用ssh连接的方式去运行PHP程序，那么当你的ssh连接关闭后，相应的PHP也会被关闭。我们可以使用
<code class="highlighter-rouge">nohup</code>命令使PHP不会被挂起。</p>

<p>执行下面的命令：</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>nohup php OrayIPSync.php &amp;
</code></pre>
</div>

<p>输入这条命令，连续按两次回车。PHP就会运作在后台，且你ssh连接关闭后也不会被挂起，实现真正的自动解析。
PHP程序的输入会自动重定向到当前目录的<code class="highlighter-rouge">nohup.out</code>文件里，时不时的查看这个文件可以让你了解到程序的运行状态。</p>

<p>好了好了，说了这么多，伸手党最想要看的是下面：</p>

<p><a href="/download/OrayIPSync">OrayIPSync.php</a></p>

<p>我把<code class="highlighter-rouge">.php</code>后缀去掉了，记得自己加上去。然后把里面的账号和密码、域名等换成自己的就OK了。</p>

<p><code class="highlighter-rouge">写博客不易，写原创的有质量的博客更不易。希望转载的请注明出处。来自：lanfly.github.io</code></p>

                        </div>
                        <!-- .entry-content -->
                        <footer class="entry-footer">
                            <span class="cat-links">Posted in <a href="/resource" rel="category tag">干货分享</a></span> </footer>
                        <!-- .entry-footer -->
                    </article>
                    <!-- #post-## -->
                    <!-- <nav class="navigation post-navigation" role="navigation">
                        <h2 class="screen-reader-text">文章导航</h2>
                        <div class="nav-links">
                            <div class="nav-previous">
                                <span>上一篇：</span>
                                <a href="" rel="prev" id="nav-previous">正在获取...</a>
                            </div>
                            <div class="nav-next">
                                <span>下一篇：</span>
                                <a href="" rel="next" id="nav-next">正在获取...</a>
                            </div>
                        </div>
                    </nav> -->
                    <div id="comments" class="comments-area">
                        <div class="comments-title-container">
                            <h2 class="comment-title"><span class="comment-number" id="commentNumber">No</span> Comments</h2>
                            <h4 class="comment-subtitle"><a href="#respond">Add yours →</a></h4>
                        </div>
                        <ol class="commentlist" id="commentlist">
                            <p style="text-align: center;">正在加载评论...</p>
                            <!-- <li class="comment even thread-even depth-1" id="li-comment-1">
                                <div id="comment-1" class="comment">
                                    <div class="avatar-container">
                                        <img alt='' src='http://localhost/wordpress/wp-content/uploads/2015/12/huidong.gif' srcset='http://0.gravatar.com/avatar/37b7597003d518630ea48a06b729a438?s=320&amp;d=retro&amp;r=g 2x' class='avatar avatar-160 photo' height='160' width='160' /> </div>
                                    <div class="comment-inner">
                                        <div class="comment-header">
                                            <h4>
                                                <a href='http://lansky.com' rel='external nofollow' class='url'>lan</a>
                                                <a class="comment-date-link" href="http://localhost/wordpress/2016/01/14/52/#comment-1" title="2016年1月14日 at 下午3:24">2016年1月14日<span> &mdash; 下午3:24</span></a>
                                            </h4>
                                        </div>
                                        <div class="comment-content post-content">
                                            <p>hello,this test reply</p>
                                            <p>hello,this test reply</p>
                                            <p>hello,this test reply</p>
                                        </div>
                                        <!-- /comment-content
                                        <div class="comment-actions">
                                            <p class="comment-reply"><a rel='nofollow' class='comment-reply-link' href='http://localhost/wordpress/2016/01/14/52/?replytocom=1#respond' onclick='return addComment.moveForm( "comment-1", "1", "respond", "52" )' aria-label='回复给lan'>Reply</a></p>
                                        </div>
                                        <!-- /comment-actions
                                    </div>
                                    <!-- /comment-inner
                                </div>
                                <!-- /comment-##
                            </li> -->
                            <!-- #comment-## -->
                        </ol>
                        <!-- 评论 -->
                        <div id="respond" class="comment-respond">
                            <div>
                                <h3 id="reply-title" class="comment-reply-title">发表你的评论</h3>
                                <small id="cancel-reply" class="cancel-reply"></small>
                            </div>
                            <form action="" method="post" id="commentform" class="comment-form">
                                <p class="comment-form-author">
                                    <label for="author">Name<span class="required">*</span></label>
                                    <input id="author" name="author" type="text" value="" size="30" required/>
                                </p>
                                <p class="comment-form-email">
                                    <label for="email">Email<span class="required">*</span></label>
                                    <input id="email" name="email" type="text" value="" size="30" placeholder="评论使用Gravatar头像" required/>
                                </p>
                                <p class="comment-form-url">
                                    <label for="url">Website</label>
                                    <input id="url" name="url" type="text" value="" size="30" placeholder="请带上 http://" />
                                </p>
                                <p class="comment-form-comment">
                                    <label for="comment">Comment</label>
                                    <textarea id="comment" name="comment" cols="45" rows="6" required></textarea>
                                </p>
                                <p class="form-submit">
                                    <input name="submit" type="submit" id="submit" class="submit" value="发表评论" />
                                    <input type='hidden' name='replyto' value='' id='replyto' />
                                </p>
                            </form>
                        </div>
                        <!-- 评论框 -->
                    </div>

                </main>
                <!-- #main -->
            </div>
            <!-- #primary -->
            <div id="secondary" class="widget-area" role="complementary">
                <aside id="recent-posts" class="widget widget_recent_entries">
                    <h1 class="widget-title">近期文章</h1>
                    <ul>
                        <li>
                            <a href="http://localhost/wordpress/2016/01/14/52/">test</a>
                        </li>
                        <li>
                            <a href="http://localhost/wordpress/2015/12/01/5/">LanEditor</a>
                        </li>
                    </ul>
                </aside>

            </div>
            <!-- #secondary -->
        </div>
        <!-- #content -->
        <footer id="colophon" class="site-footer" role="contentinfo">
            <div class="site-info">Powered by 
                <a href="http://jekyllrb.com/">jekyll</a>
                <span class="sep"> </span> Theme optimized by <a href="mailto:bluescode@outlook.com">BluesCode</a> based on <a href="http://www.andersnoren.se/teman/rams-wordpress-theme/">Rams</a> and <a href="http://alexaweidinger.com" rel="designer">Alexa Weidinger</a></div>
            <!-- .site-info -->
        </footer>
        <!-- #colophon -->
    </div>
    <!-- #page -->
    <!-- <script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script> -->
    <script type="text/javascript" src="/javascript/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/javascript/useragent.js"></script>
    <script type="text/javascript" src="/javascript/heidi.js"></script>
    <script type="text/javascript" src="/javascript/post-heidi.js"></script>
</body>

</html>
